목차

- 3.1 자바스크립트 실행 환경

### 3.1 자바스크립트 실행 환경

브라우저는 HTML, CSS, 자바스크립트를 실행해 웹 페이지를 브라우저 화면에 렌더링하는 것이 주된 목적이지만 Node.js는 브라우저 외부에서 자바스크립트 실행 환경을 제공하는 것이 주된 목적이다.

자바스크립트는 렌더링 엔진이 아닌 자바스크립트 엔진이 처리한다. HTML 파서는 script 태그를 만나면 자바스크립트 코드를 실행하기 위해 DOM 생성 프로세스를 중지하고 자바스크립트 엔진으로 제어 권한을 넘긴다.

제어 권한을 넘겨 받은 자바스크립트 엔진은 `script` 태그 내의 자바스크립트 코드 또는 script 태그의 src 어트리뷰트에 정의된 자바스크립트 파일을 로드하고 파싱하여 실행한다. 자바스크립트의 실행이 완료되면 다시 HTML 파서로 제어 권한을 넘겨서 브라우저가 중지했던 시점부터 DOM 생성을 재개한다.

브라우저는 동기적으로 HTML, CSS, Javascript를 처리한다. 이것을 script 태그의 위치에 따라 블로킹이 발생하여  DOM의 생성이 지연될 수 있다는 것을 의미한다.

주로 `body` 태그 최하단부에 `script` 태그를 위치시키는데 HTML 요소들이 스크립트 로딩 지연으로 인해 렌더링에 지장 받는 일이 발생하지 않아 페이지 로딩 시간이 단축되고 DOM이 완성되지 않은 상태에서 자바스크립트가 DOM을 조작하면 에러가 발생하기 때문이다.

✨ 브라우저 동작 원리

사용자 인터페이스의 주소 입력창에 www.naver.com을 입력한 뒤 엔터키를 누르면 브라우저 엔진이 작동하게 된다. 브라우저 엔진은 입력받은 주소값에 해당하는 데이터를 자료 저장소에서 찾는다.

만약 자료 저장소에 데이터가 없다면 입력 받은 URI 값을 렌더링 엔진에 전달해준다.

렌더링 엔진은 요청된 컨텐츠를 브라우저 화면에 표시하는 역할을 한다. 브라우저마다 렌더링 엔진을 각각 다르게 사용한다. Chrome, Safari, Opera 브라우저는 Webkit 엔진을 사용한다.

렌더링 엔진은 네트워크 계층에서 요청된 문서의 내용을 가진 후 렌더링 엔진의 기본 흐름을 따른다.

- HTML 파싱
    - 파싱된 요소를 ‘컨텐츠 트리’라는 트리의 ‘DOM 노드’로 변환
    - 외부 CSS파일, 스타일 요소도 같이 파싱
    - 스타일 정보, HTML 표시 규칙, Javascript 파싱 결과물은 ‘렌더 트리’를 만드는 데 사용
- 렌더 트리 생성
    - HTML, CSS를 파싱해서 만들어진 ‘렌더 트리’에는 색상, 면적과 같은 시각적 속성을 포함
- 렌더 트리 배치
    - DOM node는 배치 정보를 갖고 있다. 화면에 정해진 순서대로 배치하는 레이아웃 단계를 거치게 되며, 생성과정이 끝났을 때 이루어진다. 노드가 화면에 정확한 위치에 표시된다.
- 렌더 트리 페인팅
    - node 배치가 끝나면 UI 백엔드에서 렌더 트리의 각 node들을 순회하고 페인팅 작업을 한다.

✨ Reference

[https://ramincoding.tistory.com/m/entry/Web-웹-브라우저가-어떻게-동작하는가](https://ramincoding.tistory.com/m/entry/Web-%EC%9B%B9-%EB%B8%8C%EB%9D%BC%EC%9A%B0%EC%A0%80%EA%B0%80-%EC%96%B4%EB%96%BB%EA%B2%8C-%EB%8F%99%EC%9E%91%ED%95%98%EB%8A%94%EA%B0%80)<br/>
https://poiemaweb.com/js-browser